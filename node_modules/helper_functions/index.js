var async = require("async");
var mysql = require("mysql");
var conn_semantics = {
	host:'localhost',
	user:'root',
	password:'Closeme1!',
	database: 'clients',
};

// function checkDatabase(cb){
// 	var sql_all = "SELECT * FROM clients";
// 	var connection = mysql.createConnection({
// 		host:'localhost',
// 		user:'root',
// 		password:'Closeme1!',
// 		database: 'clients'
// 	});
// 	connection.connect(function(err, results){
// 		if(err){
// 			console.log("error connecting to database in check database");
// 			return cb(err);
// 		} else {
// 			connection.query(sql_all,function(err, results){
// 				connection.end()
// 				if (err){
// 					console.log(err + "error all clients query");
// 					cb({err:err});
// 				} else {
// 					cb(null, results);
// 					console.log(results + "results from all clients query");
// 				}
// 			});
// 		}
// 	})
		
// }


var a = {
	simplesql: function(sql, values_arr, callback){
		var connection = mysql.createConnection(conn_semantics);
		async.waterfall([
			function(cb) {
				connection.connect(function(err,results){
					console.log("Connected yo");
					if (err){
						cb(err);
					} else {
						cb(null, results);
					}
				});
			},
			function(_results, cb) {
				connection.query(sql, values_arr, function(err, results) {
					connection.end();
					if (err) {
						cb(err);
					} else {
						cb(null, results);
					}
				});
			}
		], function (err, results) {
			if (err) {
				console.log("Error at simplesql");
				return callback(err);
			} else {
				callback(null, results);
			}
		});
	}
}




module.exports = a, console.log("test");